version: "3"

services:

  # https://github.com/solid/node-solid-server/tree/master/docker-image
  solid:
    image: nodesolidserver/node-solid-server:latest
    container_name: solid-server
    restart: unless-stopped
    #user: "1001:1001"
    ports:
      - 8443:8443
    environment: 
      # See options: https://github.com/solid/node-solid-server#extra-flags-expert
      - "SOLID_SERVER_URI=https://solid.semanticscience.org"
      - "SOLID_SSL_KEY=/opt/solid/certs/solid.semanticscience.org/key.pem"
      - "SOLID_SSL_CERT=/opt/solid/certs/solid.semanticscience.org/fullchain.pem"
      - "SOLID_MULTIUSER=true"
      # - "SOLID_WEBID=true"

      - "SOLID_SERVER_NAME=Solid Station"
      - "SOLID_SERVER_DESCRIPTION=Solid server hosted at the Institute of Data Science at Maastricht University"
      - "SOLID_SERVER_LOGO=https://maastrichtu-ids.github.io/dsri-documentation/img/favicon.ico"

      # Nginx config for 128 pods! See the generate_urls.py scripts to generate your URLs!
      - "VIRTUAL_HOST=solid.semanticscience.org,vemonet.solid.semanticscience.org,solidforresearchtest01.solid.semanticscience.org,solidforresearchtest02.solid.semanticscience.org,solidforresearchtest03.solid.semanticscience.org,solidforresearchtest04.solid.semanticscience.org,solidforresearchtest05.solid.semanticscience.org,solidforresearchtest06.solid.semanticscience.org,solidforresearchtest07.solid.semanticscience.org,solidforresearchtest08.solid.semanticscience.org,solidforresearchtest09.solid.semanticscience.org,solidforresearchtest10.solid.semanticscience.org,solidforresearchtest11.solid.semanticscience.org,solidforresearchtest12.solid.semanticscience.org,solidforresearchtest13.solid.semanticscience.org,solidforresearchtest14.solid.semanticscience.org,solidforresearchtest15.solid.semanticscience.org,solidforresearchtest16.solid.semanticscience.org,solidforresearchtest17.solid.semanticscience.org,solidforresearchtest18.solid.semanticscience.org,solidforresearchtest19.solid.semanticscience.org,solidforresearchtest20.solid.semanticscience.org,solidforresearchtest21.solid.semanticscience.org,solidforresearchtest22.solid.semanticscience.org,solidforresearchtest23.solid.semanticscience.org,solidforresearchtest24.solid.semanticscience.org,solidforresearchtest25.solid.semanticscience.org,solidforresearchtest26.solid.semanticscience.org,solidforresearchtest27.solid.semanticscience.org,solidforresearchtest28.solid.semanticscience.org,solidforresearchtest29.solid.semanticscience.org,solidforresearchtest30.solid.semanticscience.org,solidforresearchtest31.solid.semanticscience.org,solidforresearchtest32.solid.semanticscience.org,solidforresearchtest33.solid.semanticscience.org,solidforresearchtest34.solid.semanticscience.org,solidforresearchtest35.solid.semanticscience.org,solidforresearchtest36.solid.semanticscience.org,solidforresearchtest37.solid.semanticscience.org,solidforresearchtest38.solid.semanticscience.org,solidforresearchtest39.solid.semanticscience.org,solidforresearchtest40.solid.semanticscience.org,solidforresearchtest41.solid.semanticscience.org,solidforresearchtest42.solid.semanticscience.org,solidforresearchtest43.solid.semanticscience.org,solidforresearchtest44.solid.semanticscience.org,solidforresearchtest45.solid.semanticscience.org,solidforresearchtest46.solid.semanticscience.org,solidforresearchtest47.solid.semanticscience.org,solidforresearchtest48.solid.semanticscience.org,solidforresearchtest49.solid.semanticscience.org,solidforresearchtest50.solid.semanticscience.org,solidforresearchtest51.solid.semanticscience.org,solidforresearchtest52.solid.semanticscience.org,solidforresearchtest53.solid.semanticscience.org,solidforresearchtest54.solid.semanticscience.org,solidforresearchtest55.solid.semanticscience.org,solidforresearchtest56.solid.semanticscience.org,solidforresearchtest57.solid.semanticscience.org,solidforresearchtest58.solid.semanticscience.org,solidforresearchtest59.solid.semanticscience.org,solidforresearchtest60.solid.semanticscience.org,solidforresearchtest61.solid.semanticscience.org,solidforresearchtest62.solid.semanticscience.org,solidforresearchtest63.solid.semanticscience.org,solidforresearchtest64.solid.semanticscience.org,solidforresearchtest65.solid.semanticscience.org,solidforresearchtest66.solid.semanticscience.org,solidforresearchtest67.solid.semanticscience.org,solidforresearchtest68.solid.semanticscience.org,solidforresearchtest69.solid.semanticscience.org,solidforresearchtest70.solid.semanticscience.org,solidforresearchtest71.solid.semanticscience.org,solidforresearchtest72.solid.semanticscience.org,solidforresearchtest73.solid.semanticscience.org,solidforresearchtest74.solid.semanticscience.org,solidforresearchtest75.solid.semanticscience.org,solidforresearchtest76.solid.semanticscience.org,solidforresearchtest77.solid.semanticscience.org,solidforresearchtest78.solid.semanticscience.org,solidforresearchtest79.solid.semanticscience.org,solidforresearchtest80.solid.semanticscience.org,solidforresearchtest81.solid.semanticscience.org,solidforresearchtest82.solid.semanticscience.org,solidforresearchtest83.solid.semanticscience.org,solidforresearchtest84.solid.semanticscience.org,solidforresearchtest85.solid.semanticscience.org,solidforresearchtest86.solid.semanticscience.org,solidforresearchtest87.solid.semanticscience.org,solidforresearchtest88.solid.semanticscience.org,solidforresearchtest89.solid.semanticscience.org,solidforresearchtest90.solid.semanticscience.org,solidforresearchtest91.solid.semanticscience.org,solidforresearchtest92.solid.semanticscience.org,solidforresearchtest93.solid.semanticscience.org,solidforresearchtest94.solid.semanticscience.org,solidforresearchtest95.solid.semanticscience.org,solidforresearchtest96.solid.semanticscience.org,solidforresearchtest97.solid.semanticscience.org,solidforresearchtest98.solid.semanticscience.org,solidforresearchtest99.solid.semanticscience.org,solidforresearchtest100.solid.semanticscience.org,solidforresearchtest101.solid.semanticscience.org,solidforresearchtest102.solid.semanticscience.org,solidforresearchtest103.solid.semanticscience.org,solidforresearchtest104.solid.semanticscience.org,solidforresearchtest105.solid.semanticscience.org,solidforresearchtest106.solid.semanticscience.org,solidforresearchtest107.solid.semanticscience.org,solidforresearchtest108.solid.semanticscience.org,solidforresearchtest109.solid.semanticscience.org,solidforresearchtest110.solid.semanticscience.org,solidforresearchtest111.solid.semanticscience.org,solidforresearchtest112.solid.semanticscience.org,solidforresearchtest113.solid.semanticscience.org,solidforresearchtest114.solid.semanticscience.org,solidforresearchtest115.solid.semanticscience.org,solidforresearchtest116.solid.semanticscience.org,solidforresearchtest117.solid.semanticscience.org,solidforresearchtest118.solid.semanticscience.org,solidforresearchtest119.solid.semanticscience.org,solidforresearchtest120.solid.semanticscience.org,solidforresearchtest121.solid.semanticscience.org,solidforresearchtest122.solid.semanticscience.org,solidforresearchtest123.solid.semanticscience.org,solidforresearchtest124.solid.semanticscience.org,solidforresearchtest125.solid.semanticscience.org,solidforresearchtest126.solid.semanticscience.org,solidforresearchtest127.solid.semanticscience.org,solidforresearchtest128.solid.semanticscience.org"
      # Let's encrypt does not work for 100 certs, so we need to limit to at least the main solid domain
      # And accept the security risk when accessing users subdomains
      - "LETSENCRYPT_HOST=solid.semanticscience.org,vemonet.solid.semanticscience.org,solidforresearchtest01.solid.semanticscience.org,solidforresearchtest02.solid.semanticscience.org,solidforresearchtest03.solid.semanticscience.org"
      # ,solidforresearchtest04.solid.semanticscience.org,solidforresearchtest05.solid.semanticscience.org,solidforresearchtest06.solid.semanticscience.org,solidforresearchtest07.solid.semanticscience.org,solidforresearchtest08.solid.semanticscience.org,solidforresearchtest09.solid.semanticscience.org,solidforresearchtest10.solid.semanticscience.org,solidforresearchtest11.solid.semanticscience.org,solidforresearchtest12.solid.semanticscience.org,solidforresearchtest13.solid.semanticscience.org,solidforresearchtest14.solid.semanticscience.org,solidforresearchtest15.solid.semanticscience.org,solidforresearchtest16.solid.semanticscience.org,solidforresearchtest17.solid.semanticscience.org,solidforresearchtest18.solid.semanticscience.org,solidforresearchtest19.solid.semanticscience.org,solidforresearchtest20.solid.semanticscience.org,solidforresearchtest21.solid.semanticscience.org,solidforresearchtest22.solid.semanticscience.org,solidforresearchtest23.solid.semanticscience.org,solidforresearchtest24.solid.semanticscience.org,solidforresearchtest25.solid.semanticscience.org,solidforresearchtest26.solid.semanticscience.org,solidforresearchtest27.solid.semanticscience.org,solidforresearchtest28.solid.semanticscience.org,solidforresearchtest29.solid.semanticscience.org,solidforresearchtest30.solid.semanticscience.org,solidforresearchtest31.solid.semanticscience.org,solidforresearchtest32.solid.semanticscience.org,solidforresearchtest33.solid.semanticscience.org,solidforresearchtest34.solid.semanticscience.org,solidforresearchtest35.solid.semanticscience.org,solidforresearchtest36.solid.semanticscience.org,solidforresearchtest37.solid.semanticscience.org,solidforresearchtest38.solid.semanticscience.org,solidforresearchtest39.solid.semanticscience.org,solidforresearchtest40.solid.semanticscience.org,solidforresearchtest41.solid.semanticscience.org,solidforresearchtest42.solid.semanticscience.org,solidforresearchtest43.solid.semanticscience.org,solidforresearchtest44.solid.semanticscience.org,solidforresearchtest45.solid.semanticscience.org,solidforresearchtest46.solid.semanticscience.org,solidforresearchtest47.solid.semanticscience.org,solidforresearchtest48.solid.semanticscience.org,solidforresearchtest49.solid.semanticscience.org,solidforresearchtest50.solid.semanticscience.org,solidforresearchtest51.solid.semanticscience.org,solidforresearchtest52.solid.semanticscience.org,solidforresearchtest53.solid.semanticscience.org,solidforresearchtest54.solid.semanticscience.org,solidforresearchtest55.solid.semanticscience.org,solidforresearchtest56.solid.semanticscience.org,solidforresearchtest57.solid.semanticscience.org,solidforresearchtest58.solid.semanticscience.org,solidforresearchtest59.solid.semanticscience.org,solidforresearchtest60.solid.semanticscience.org,solidforresearchtest61.solid.semanticscience.org,solidforresearchtest62.solid.semanticscience.org,solidforresearchtest63.solid.semanticscience.org,solidforresearchtest64.solid.semanticscience.org,solidforresearchtest65.solid.semanticscience.org,solidforresearchtest66.solid.semanticscience.org,solidforresearchtest67.solid.semanticscience.org,solidforresearchtest68.solid.semanticscience.org,solidforresearchtest69.solid.semanticscience.org,solidforresearchtest70.solid.semanticscience.org,solidforresearchtest71.solid.semanticscience.org,solidforresearchtest72.solid.semanticscience.org,solidforresearchtest73.solid.semanticscience.org,solidforresearchtest74.solid.semanticscience.org,solidforresearchtest75.solid.semanticscience.org,solidforresearchtest76.solid.semanticscience.org,solidforresearchtest77.solid.semanticscience.org,solidforresearchtest78.solid.semanticscience.org,solidforresearchtest79.solid.semanticscience.org,solidforresearchtest80.solid.semanticscience.org,solidforresearchtest81.solid.semanticscience.org,solidforresearchtest82.solid.semanticscience.org,solidforresearchtest83.solid.semanticscience.org,solidforresearchtest84.solid.semanticscience.org,solidforresearchtest85.solid.semanticscience.org,solidforresearchtest86.solid.semanticscience.org,solidforresearchtest87.solid.semanticscience.org,solidforresearchtest88.solid.semanticscience.org,solidforresearchtest89.solid.semanticscience.org,solidforresearchtest90.solid.semanticscience.org,solidforresearchtest91.solid.semanticscience.org,solidforresearchtest92.solid.semanticscience.org,solidforresearchtest93.solid.semanticscience.org,solidforresearchtest94.solid.semanticscience.org,solidforresearchtest95.solid.semanticscience.org,solidforresearchtest96.solid.semanticscience.org,solidforresearchtest97.solid.semanticscience.org,solidforresearchtest98.solid.semanticscience.org,solidforresearchtest99.solid.semanticscience.org,solidforresearchtest100.solid.semanticscience.org,solidforresearchtest101.solid.semanticscience.org,solidforresearchtest102.solid.semanticscience.org,solidforresearchtest103.solid.semanticscience.org,solidforresearchtest104.solid.semanticscience.org,solidforresearchtest105.solid.semanticscience.org,solidforresearchtest106.solid.semanticscience.org,solidforresearchtest107.solid.semanticscience.org,solidforresearchtest108.solid.semanticscience.org,solidforresearchtest109.solid.semanticscience.org,solidforresearchtest110.solid.semanticscience.org,solidforresearchtest111.solid.semanticscience.org,solidforresearchtest112.solid.semanticscience.org,solidforresearchtest113.solid.semanticscience.org,solidforresearchtest114.solid.semanticscience.org,solidforresearchtest115.solid.semanticscience.org,solidforresearchtest116.solid.semanticscience.org,solidforresearchtest117.solid.semanticscience.org,solidforresearchtest118.solid.semanticscience.org,solidforresearchtest119.solid.semanticscience.org,solidforresearchtest120.solid.semanticscience.org,solidforresearchtest121.solid.semanticscience.org,solidforresearchtest122.solid.semanticscience.org,solidforresearchtest123.solid.semanticscience.org,solidforresearchtest124.solid.semanticscience.org,solidforresearchtest125.solid.semanticscience.org,solidforresearchtest126.solid.semanticscience.org,solidforresearchtest127.solid.semanticscience.org,solidforresearchtest128.solid.semanticscience.org"

      - "VIRTUAL_PORT=8443"
      - "VIRTUAL_PROTO=https"
      
      # Disable unsigned certs checks
      - NODE_TLS_REJECT_UNAUTHORIZED=0
    volumes: 
      - /data/certs:/opt/solid/certs
      - /data/solid/data:/opt/solid/data
      - /data/solid/.db:/opt/solid/.db
      - /data/solid/config:/opt/solid/config
